getListaNotificaciones=select nidnotificacion,ndescripcion,nfecha,nnivel,pernombres||' '||perapellidos,case when (neestado is null) then 1 else neestado end from notificaciones left join notificacion_estado on (nidnotificacion=neidnotificacion and neidpersona=?) ,personal where perid=nasigpor and (nidpersona=? or nperfil=? or nperfil=? or nperfil=?) and nestado=1 and nidnotificacion<>all (select neidnotificacion from notificacion_estado where neestado=3 and neidpersona=?) order by nestado,nnivel desc
nuevaNotificacion=insert into notificaciones (nidpersona,nperfil,ndescripcion,nfecha,nestado,nnivel)values(?,?,?,current_date,?,1,?)
cambiaEstado=update notificacion_estado set neestado=? where neidnotificacion=? and neidpersona=?
getListaPerfiles= select bperid,bpdescripcion from b_perfiles  where bpactivo=true order by bperid
buscaNotificacion=select neidnotificacion from notificacion_estado where neidnotificacion=? and neidpersona=?
insertaEstadoIndividual=insert into notificacion_estado (neidnotificacion,neidpersona,neestado,nefechatencion) values(?,?,?,current_date)
getBuscarPersonas=select perid,pernumdoc,pernombres,perapellidos,case when (binvidgrupoinv is null) then 'Externo' else 'Investigador' end from usuario_sistema,personal left join b_investigadores on (perid=binvidper) where pernumdoc ilike ?  and pernombres ilike ? and perapellidos ilike ? and usidpersona=perid order by pernumdoc,pernombres,perapellidos
getBuscarPersonas2=select perid,pernumdoc,pernombres,perapellidos, case when (binvidgrupoinv is null) then 'Externo' else 'Investigador' end from usuario_sistema,personal left join b_investigadores on (perid=binvidper) where (pernumdoc ilike ? or pernumdoc is null)  and pernombres ilike ? and perapellidos ilike ? and usidpersona=perid order by pernumdoc,pernombres,perapellidos
insertaNotificacion=insert into notificaciones(nidpersona,nperfil,ndescripcion,nfecha,nestado,nnivel,nasigpor) values (?,?,?,current_date,?,?,?);